---
title: 物联网智能小电视
date: 2021-11-1 18:32:00
tags: 
 - ESP32
categories: 
 - 智能家居
---

最近心血来潮，想自己DIY一些小物件，顺便学习一下嵌入式开发相关知识。于是，购买了ESP32和1.54英寸的TFT液晶屏，先从简单的MicroPython入手，实现一个时钟加天气预报的桌面小摆件。

最近心血来潮，想自己DIY一些小物件，顺便学习一下嵌入式开发相关知识。于是，购买了ESP32和1.54英寸的TFT液晶屏，先从简单的MicroPython入手，实现一个时钟加天气预报的桌面小摆件。

![](20211101_102902238_iOS.jpg)

<!-- more -->

到目前为止，主要实现了以下功能：

- 开机自动连接Wi-Fi

- 显示时间和日期，并通过NTP自动校准时间
- 显示实时的气温，以及当天的天气状况
- 根据IP地址定位所在的区域，精确到区级位置
- 显示Wi-Fi的图标

在制作过程中，遇到了许多的问题，其中，以下问题花费的时间比较多，简单总结一下。

- 由于显示屏驱动的功能局限，不支持透明字体，如果使用背景图片，字体无法呈现透明效果，视觉效果很差。以下是一开始的设计，本打算采用美观一点的背景图片。

![](20211030_014042417_iOS.jpg)

- 还是显示屏驱动的功能局限，只支持jpg格式的图片，不支持透明背景的png格式图片。因此，只能采用“笨办法”，修改图片背景颜色，保持与屏幕显示颜色一致。
- 购买的两块TFT屏幕，大小分别为1.3和.154英寸。除了尺寸的区别，前者不包含CS引脚（注：1.54英寸屏的CS引脚必须接地GND）。带来的问题就是，1.54寸屏的初始化波特率最高只能达到23Mhz，而1.3寸屏的初始化波特率能达到40Mhz。另外，1.54英寸屏每次上电后，屏幕无法显示画面，或者显示画面几秒后，画面就会消失，重置后能恢复。1.3寸屏没有这样的问题。目前还没有找到原因，猜测可能跟显示屏驱动有关。
- 为了显示中文字体，需要将字体库文件通过工具转换成bitmap模块。

下一步，需要再进一步优化，并增加新的功能：

- 开机动画
- 微信扫描后，配置Wi-Fi账号和密码
- Wi-Fi图标显示网络的通断
- 手机信息传送到屏幕
- 显示股票信息
